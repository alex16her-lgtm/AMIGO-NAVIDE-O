<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>ğŸ„ Amigo NavideÃ±o Marvel</title>

<style>
body { font-family: Arial; background:#0f172a; color:white; padding:20px }
h1 { text-align:center }
.container { display:grid; grid-template-columns:1fr 1fr; gap:20px }
.card { background:#1e293b; padding:20px; border-radius:10px }
button { padding:10px; width:100%; margin-top:10px; cursor:pointer }
textarea, input { width:100%; padding:10px; margin-top:10px }
ul { padding-left:20px }
.admin { display:none; margin-top:20px; background:#334155; padding:15px; border-radius:10px }
</style>
</head>

<body>

<h1>ğŸ„ Amigo NavideÃ±o Marvel ğŸ¦¸â€â™‚ï¸</h1>

<input id="code" placeholder="Ingresa tu cÃ³digo Ãºnico (AMIGO01)">
<button onclick="assignCharacter()">ğŸ¡ Asignar personaje</button>
<p><b>Mi personaje:</b> <span id="myCharacter">---</span></p>

<button onclick="drawGift()">ğŸ Sortear a quiÃ©n regalar</button>
<p><b>Regalo para:</b> <span id="giftCharacter">---</span></p>

<textarea id="rulesInput" placeholder="Escribe tu personaje y opciones de regalo"></textarea>
<button onclick="saveRule()">ğŸ’¾ Guardar opciones</button>

<h3>ğŸ€ Opciones guardadas</h3>
<ul id="rulesList"></ul>

<!-- ADMIN -->
<input id="adminKey" placeholder="Clave admin">
<button onclick="unlockAdmin()">ğŸ”</button>

<div class="admin" id="adminPanel">
<button onclick="resetAll()">â™»ï¸ Reiniciar todo el sorteo</button>
</div>

<script>
const ADMIN_KEY = "MARVEL2025";

const characters = [
"Iron Man","Capitan America","Thor","Hulk","Viuda Negra","Ojo de Halcon",
"Spider-Man","Doctor Strange","Pantera Negra","Bruja Escarlata","Vision",
"Hombre Hormiga","Avispa","Loki","Capitan Marvel","Deadpool","Thanos"
];

let data = JSON.parse(localStorage.getItem("data")) || {};
let available = JSON.parse(localStorage.getItem("available")) || [...characters];
let rules = JSON.parse(localStorage.getItem("rules")) || [];

function saveAll() {
  localStorage.setItem("data", JSON.stringify(data));
  localStorage.setItem("available", JSON.stringify(available));
  localStorage.setItem("rules", JSON.stringify(rules));
}

function assignCharacter() {
  const code = document.getElementById("code").value.trim().toUpperCase();
  if (!code) return alert("Ingresa tu cÃ³digo");

  if (!data[code]) data[code] = {};

  if (!data[code].me) {
    const index = Math.floor(Math.random() * available.length);
    data[code].me = available.splice(index,1)[0];
    saveAll();
  }

  document.getElementById("myCharacter").innerText = data[code].me;
}

function drawGift() {
  const code = document.getElementById("code").value.trim().toUpperCase();
  if (!code || !data[code]?.me) return alert("Primero asigna tu personaje");

  if (!data[code].gift) {
    const index = Math.floor(Math.random() * available.length);
    data[code].gift = available.splice(index,1)[0];
    saveAll();
  }

  document.getElementById("giftCharacter").innerText = data[code].gift;
}

function saveRule() {
  const text = document.getElementById("rulesInput").value.trim();
  if (!text) return;
  rules.push(text);
  document.getElementById("rulesInput").value = "";
  saveAll();
  renderRules();
}

function renderRules() {
  const ul = document.getElementById("rulesList");
  ul.innerHTML = "";
  rules.forEach(r => {
    const li = document.createElement("li");
    li.textContent = r;
    ul.appendChild(li);
  });
}

function unlockAdmin() {
  if (document.getElementById("adminKey").value === ADMIN_KEY) {
    document.getElementById("adminPanel").style.display = "block";
  }
}

function resetAll() {
  if (confirm("Â¿Seguro que deseas reiniciar TODO?")) {
    localStorage.clear();
    location.reload();
  }
}

renderRules();
</script>

</body>
</html>



